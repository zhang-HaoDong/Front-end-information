!function(s,i){function t(t){this.wrap=t,this.dataList=[],this.controlIndex=null,this.rotateTimer=null}t.prototype={init(){this.getDom(),this.getData("../mock/data.json")},getDom(){this.record=document.querySelector(".songImg img"),this.controlBtns=document.querySelectorAll(".control li")},getData(t){s.ajax({url:t,method:"get",success:t=>{this.dataList=t,this.listPlay(),this.controlIndex=new i.CreateIndex(this.dataList.length),this.loadMusic(this.controlIndex.index),this.musicControl()},error:t=>{console.log("数据请求失败")}})},loadMusic(t){i.render(this.dataList[t]),i.music.load(this.dataList[t].audioSrc),"play"===i.music.status&&(i.music.play(),this.controlBtns[2].className="playing",this.imgRotate(0)),this.list.changeSelect(t),this.curIndex=t},musicControl(){this.controlBtns[1].addEventListener("touchend",()=>{i.music.status="play",this.loadMusic(this.controlIndex.prev())}),this.controlBtns[2].addEventListener("touchend",()=>{"play"===i.music.status?(i.music.pause(),i.music.status="pause",this.controlBtns[2].className="",clearInterval(this.rotateTimer)):(i.music.play(),i.music.status="play",this.controlBtns[2].className="playing",this.imgRotate(this.record.dataset.rotate||0))}),this.controlBtns[3].addEventListener("touchend",()=>{i.music.status="play",this.loadMusic(this.controlIndex.next())})},imgRotate(t){clearInterval(this.rotateTimer),this.rotateTimer=setInterval(()=>{this.record.style.transform=`rotate(${t}deg)`,360<=(t=+t+.2)&&(t=0),this.record.dataset.rotate=t},1e3/60)},listPlay(){this.list=i.listControl(this.dataList,this.wrap),this.controlBtns[4].addEventListener("touchend",()=>{this.list.slideUp()}),this.list.musicList.forEach((t,s)=>{t.addEventListener("touchend",()=>{this.curIndex==s&&retrun,i.music.status="play",this.loadMusic(s),this.controlIndex.index=s,this.list.slideDown()})})}},new t(document.getElementById("wrap")).init()}(window.Zepto,window.player);